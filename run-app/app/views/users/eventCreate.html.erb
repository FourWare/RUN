<h1>Create event</h1>

<div style='width: 800px;'>
  <div id="mapEventCreate" style='width: 400px; height: 400px;'></div>
</div>

<script type="text/javascript">

var directionsDisplay = new google.maps.DirectionsRenderer();
var directionsService = new google.maps.DirectionsService();

function calcRoute() {
  var origin    = markers[0].getPosition();
  var destination = markers[1].getPosition();
  var request = {
      origin:      origin,
      destination: destination,
      travelMode:  google.maps.TravelMode.DRIVING
  };
  directionsService.route(request, function(response, status) {
    if (status == google.maps.DirectionsStatus.OK) {
      directionsDisplay.setDirections(response);
      console.log("OK");
    }
  });
}
var markers = [];
handler = Gmaps.build('Google');
handler.buildMap({ internal: {id: 'mapEventCreate'}, 
  provider : {
    zoom: 17,
    center: new google.maps.LatLng(4.635540,-74.082807),
  }
  });

placeMarker(new google.maps.LatLng(4.635540,-74.082807));

  google.maps.event.addListener(handler.getMap(), 'click', function(event) {
  placeMarker(event.latLng);
  console.log("add");
});

var delMarker = function (markerPar) {
    removeMarker(markerPar);
    
}
function placeMarker(location) {
    var marker = new google.maps.Marker({
        position: location, 
        map: handler.getMap(),
        draggable: true
    });
    markers.push(marker);
    //console.log(marker.getPosition().lat());
    if (markers.length > 1){
      calcRoute();
    }
    google.maps.event.addListener(marker, 'click', function(event) {
      marker.setMap(null);
    });
}
</script>

